# ==========================================================================================
# EnvSync Configuration - Genesis v2.0.1a
# ==========================================================================================
# This file shows the configuration needed to enable EnvSync Seed Manifest synchronization
# Add these variables to your Render and Netlify environment dashboards
# ==========================================================================================

# === ENVSYNC CORE CONFIGURATION ===

# Enable EnvSync engine
ENVSYNC_ENABLED=true

# Sync mode: "dry-run" (preview only) or "enforce" (apply changes)
ENVSYNC_MODE=enforce

# Sync schedule: "@hourly" or "@daily"
ENVSYNC_SCHEDULE=@hourly

# Canonical source: "file" (uses seed manifest) or "env" (uses current environment)
# Set to "file" to use the EnvSync Seed Manifest
ENVSYNC_CANONICAL_SOURCE=file

# Target platforms (comma-separated)
ENVSYNC_TARGETS=render,netlify

# === TOKEN DISCOVERY ===

# Discovery order for API tokens
ENVSYNC_DISCOVERY_ORDER=env,secret_files,vault,dashboard

# Secret file names to check
ENVSYNC_SECRET_FILENAMES=render.token,netlify.token

# Vault keys for API tokens
ENVSYNC_VAULT_TOKEN_KEYS=RENDER_API_TOKEN,NETLIFY_API_TOKEN

# === PROVIDER CONFIGURATION ===

# Render service ID (find in Render dashboard)
RENDER_SERVICE_ID=srv-xxxxx

# Netlify site ID (find in Netlify dashboard)
NETLIFY_SITE_ID=xxxxx

# === SYNC FILTERING ===

# Only sync variables starting with these prefixes (comma-separated)
# Note: Variables in the seed manifest are automatically filtered
ENVSYNC_INCLUDE_PREFIXES=BRIDGE_,SR_,HEART_,ENVSYNC_,LINK_,BLUEPRINTS_,DB_,HEALTH_,FEDERATION_,WATCHDOG_,PREDICTIVE_,HOST,GENESIS_

# Exclude variables starting with these prefixes
ENVSYNC_EXCLUDE_PREFIXES=SECRET_,INTERNAL_,DEBUG_,DATABASE_URL,RENDER_,NETLIFY_

# Allow EnvSync to delete variables that exist on platform but not in canonical source
# WARNING: Set to true with caution - this will remove platform-only variables
ENVSYNC_ALLOW_DELETIONS=false

# === GENESIS INTEGRATION ===

# Enable Genesis mode for event bus integration
GENESIS_MODE=enabled

# Enable Genesis event persistence
GENESIS_PERSISTENCE_ENABLED=true

# Path to Genesis event database
GENESIS_DATABASE_PATH=bridge_backend/.genesis/events.db

# === PLATFORM-SPECIFIC CREDENTIALS ===
# These should be set securely in your platform dashboards, not committed to git

# Render API token (create in Render Account Settings → API Keys)
# RENDER_API_TOKEN=rnd_xxxxxxxxxxxxxxxxxxxxx

# Netlify API token (create in Netlify User Settings → Applications → Personal access tokens)
# NETLIFY_API_TOKEN=nfp_xxxxxxxxxxxxxxxxxxxxx

# ==========================================================================================
# Usage Instructions
# ==========================================================================================
#
# 1. RENDER SETUP:
#    - Go to your Render service dashboard
#    - Navigate to Environment tab
#    - Add all variables above (excluding commented ones)
#    - Set RENDER_API_TOKEN in a Secret Group
#    - Set RENDER_SERVICE_ID to your actual service ID
#
# 2. NETLIFY SETUP:
#    - Go to your Netlify site dashboard
#    - Navigate to Site settings → Environment variables
#    - Add all variables above (excluding commented ones)
#    - Set NETLIFY_API_TOKEN securely
#    - Set NETLIFY_SITE_ID to your actual site ID
#
# 3. VERIFICATION:
#    - Deploy your application
#    - Visit: https://your-app.onrender.com/envsync/health
#    - Should show: {"enabled": true, "mode": "enforce", ...}
#
# 4. MANUAL SYNC:
#    - Dry run: POST /envsync/dry-run/render
#    - Apply: POST /envsync/apply-all
#
# 5. MONITORING:
#    - Check Genesis bus for envsync.drift and envsync.complete events
#    - Review logs for sync operations
#    - Monitor platform dashboards for variable changes
#
# ==========================================================================================
